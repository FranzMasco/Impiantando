<!DOCTYPE html>
<html>
    <head>
        <title> Gestione Centro Sportivo Admin </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="script.js"></script>
        <script>
            function admin_homepage(){
                var username = getCookie("username");
                var user_id = getCookie("user_id");
                var token = getCookie("token");
                var user_level = getCookie("user_level");
                var sport_center_name = getCookie("sport_center_name");
                var sport_center_id = getCookie("sport_center_id");
                //console.log(username);
                //console.log(user_id);
                //console.log(token);
                var outputJS = document.getElementById("outputJS");

                if(username=="" || user_id=="" || token=="" || user_level=="" || user_level!="administrator"){
                    outputJS.innerHTML =
                    `
                        <p>Authentication required</p>
                        <a href="index.html">Homepage</a>
                    `;
                }else{
                    outputJS.innerHTML =
                    `
                    <p><b>Administrator user: </b>`+username+`</p>
                    <p><b>Sport center: </b>`+sport_center_name+`</p>
                    <button onclick="loadCourses_administrator('`+sport_center_id+`')">Display courses</button>
                    <button onclick="loadFacilities_administrator('`+sport_center_id+`')">Display facilities</button>
                    <button onclick="loadManagers_administrator('`+sport_center_id+`')">Display managers</button><br>
                    <br>
                    <button onclick="show_insert_course_form('`+sport_center_id+`')">Add new course</button><button onclick="show_insert_form()">Add new sport facility</button>
                    <div id="insertNewFacility" hidden="true">
                        <br>
                        <p>Fill the following gaps in order to registrer a new sport facility in your sport center</p>
                        <input type="text" id="insertNewFacility_name" name="name" placeholder="Insert name new facility..."><br>
                        <textarea name="description" id="insertNewFacility_description" rows="4" cols="50" placeholder="Insert description..."></textarea><br>
                        <input type="button" name="confirm_insert" value="Confirm" onclick="insertSportFacility()">
                        <input type="button" name="cancel_insert" value="Cancel" onclick="close_insert_form()">
                        <br>
                    </div>
                    <div id="output_insertNewCourse">
                    </div>
                    <br>
                    <hr>
                    <div id="output_facilities">
                        There are no sport facilities registered yet
                    </div>
                    <br>
                    `;
                    loadFacilities_administrator(sport_center_id);
                }

            }
            
            //Hide sport facility modification form
            function close_form(id_sport_facility){
                document.getElementById("editForm"+id_sport_facility).hidden=true
            }

            //Show sport facility modification form
            function show_form(id_sport_facility){
                document.getElementById("editForm"+id_sport_facility).hidden=false
            }
            
            //Show form to insert a new sport facility
            function show_insert_form(){
                close_insert_course_form();  //close the form to add a new course which could be open
                document.getElementById("insertNewFacility").hidden=false
            }

            //Show form to insert a new sport facility
            function close_insert_form(){
                //reset fields
                document.getElementById("insertNewFacility_name").value="";
                document.getElementById("insertNewFacility_description").value="";

                document.getElementById("insertNewFacility").hidden=true;
            }

            //Show form to insert a new sport course
            function show_insert_course_form(sport_center_id){
                close_insert_form();  //close the form to add a new sport facility which could be open
                load_formNewCourse(sport_center_id);
            }

            //Show form to insert a new sport course
            function close_insert_course_form(){
                const html_form_new_course = document.getElementById('output_insertNewCourse');
                html_form_new_course.innerHTML="";
            }


            //Context: insert new course
            //Purpose: insert a new from to interval in the input date
            function addInterval(day){
                const br = document.createElement("br"); 
                const span = document.createElement("span");
                const from = document.createElement("input"); 
                const to = document.createElement("input");

                from.type="time";
                to.type="time"; 

                span.name="interval";
                span.appendChild(from);
                span.appendChild(to);
                
                //Add <br>
                document.getElementById(day).appendChild(br);

                //Add interval
                document.getElementById(day).appendChild(span);
            }

        </script>
    </head>
    <body>
        <h1>Impiantando</h1>
        <a href="index.html">Homepage</a>
        <div id="outputJS"></div>
        <script>admin_homepage()</script>
    </body>
</html>